# Inventory file

Инвентарный файл - это файл, в котором описываются устройства, к которым Ansible будет подключаться.

В инвентарном файле устройства могут указываться используя IP-адреса или имена. Устройства могут быть указаны по одному или разбиты на группы. Файл может быть описан в формате INI или YAML.

# Ad Hoc commands

Ad-hoc команды - это возможность запустить какое-то действие Ansible из командной строки.

Примеры Ad-Hoc комманд:
`ansible -i hosts.txt all-m ping`
`ansible all -i '157.230.82.133, ' -u root -m ping`

# Config file

Настройки Ansible можно менять в конфигурационном файле.

Конфигурационный файл Ansible может храниться в разных местах (файлы перечислены в порядке уменьшения приоритета):

1. ANSIBLE_CONFIG (переменная окружения)
2. ansible.cfg (в текущем каталоге)
3. ~/.ansible.cfg (в домашнем каталоге пользователя)
4. /etc/ansible/ansible.cfg

Ansible ищет файл конфигурации в указанном порядке и использует первый найденный (конфигурация из разных файлов не совмещается).

# Modules 

У Ansible есть библиотека модулей(root/ansible/modules). Модули отвечают за действия, которые выполняет Ansible. Обычно это какие-то небольшие задачи.На вход модулю подается JSON(внутри Ansible). После выполнения модуль возвращает результаты в формате JSON. 

В библеотеке много разных модулей такие как: Ping, Setup, apt, shell и другие

Модули можно выполнять отдельно, в ad-hoc командах или собирать в определенный сценарий (play), а затем в playbook.

При повторном запуске одно и того же модуля он вносит изменения, если система уже не находится в желаемом состоянии. Исключение - модуль raw всегда вносит изменения.

В Ansible модули разделены на категории по тому кто их поддерживает:

1. core - модули, которые поддерживает основная команда разработчиков Ansible.
2. network - поддерживает Ansible Network Team.
3. certified - поддерживают партнеры Ansible
4. community - поддерживает сообщество Ansible

Ad-Hoc комманда с вызовом модуля ios_command:
`ansible 192.168.100.1 -m ios_command -a "commands='sh ip int br'"`

# Playbook

Playbook (файл сценариев) — это файл, в котором описываются действия, которые нужно выполнить на какой-то группе хостов.

Внутри playbook:
1. play - это набор задач, которые нужно выполнить для конкретной группы хостов
2. task - конкретная задача(внутри play).

# Variables

Переменные указываются в (порядок по приоритету переменных):
1. При вызове playbook через параметр –extra-vars
2. Переменные, полученные через параметр register
3. Переменные сценария (play)
4. host facts (Факты хоста)
5. host_vars
6. group_vars
7. Переменные Inventory file для хостов
8. Переменные для группы хостов в инвентарном файле
9. Inventory file

Каталоги `group_vars/` и `host_vars/` должны находиться в том же каталоге где и playbook, или могут находиться внутри каталога inventory (первый вариант более распространенный).

Inventory file, Playbook, специальных файлах. По сути - практически везде.

Inventory file:

`[cisco_routers:vars]`

`ntp_server=192.168.255.100`

`log_server=10.255.100.1`

Playbook:

`vars:`
`    interfaces: sh ip int br`